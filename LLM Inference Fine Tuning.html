<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LLM Inference Tuning Playground</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: system-ui, sans-serif; background:#0f172a; color:#e5e7eb; margin:0; }
.container { max-width:1100px; margin:auto; padding:20px; }
.section { background:#020617; border:1px solid #1e293b; border-radius:10px; padding:16px; margin-bottom:18px; }
h1,h2 { margin-top:0; }
h2 { border-bottom:1px solid #334155; padding-bottom:6px; }
label { display:block; margin-top:10px; font-weight:600; }
input,select,textarea,button { width:100%; margin-top:6px; padding:8px; border-radius:6px; border:1px solid #334155; background:#020617; color:#e5e7eb; box-sizing:border-box; }
textarea { min-height:90px; }
button { background:#2563eb; font-weight:700; cursor:pointer; }
button:disabled { background:#475569; cursor:not-allowed; }
.status { margin-top:10px; padding:8px; border-radius:6px; font-size:0.9em; }
.ok { background:#052e16; color:#bbf7d0; }
.err { background:#3f1d1d; color:#fecaca; }
.row { display:flex; gap:12px; flex-wrap:wrap; }
.col { flex:1; min-width:220px; }
.slider { display:flex; gap:8px; align-items:center; }
.output { background:#020617; border:1px solid #334155; border-radius:8px; padding:10px; max-height:300px; overflow:auto; white-space:pre-wrap; }
.meta { font-size:0.85em; color:#93c5fd; margin-top:6px; }
.explain { font-size:0.85em; color:#cbd5f5; }
</style>
</head>
<body>
<div class="container">
<h1>üß™ LLM Inference Tuning Playground</h1>

<div class="section">
<h2>üîê API Key Setup</h2>
<label>API Key</label>
<input id="apiKey" placeholder="Paste Gemini API key">
<button id="validateBtn">Validate API Key</button>
<div id="apiStatus" class="status" style="display:none"></div>
<div class="explain">Validation checks if your key can list models. Generation may still fail due to quota or permissions.</div>
</div>

<div class="section">
<h2>üß† Model Selection</h2>
<select id="modelSelect" disabled></select>
<div class="explain">If the selected model fails, the app will fall back to a safe default.</div>
</div>

<div class="section">
<h2>üé≠ Response Style</h2>
<div id="presetBox"></div>
</div>

<div class="section">
<h2>üéõÔ∏è Model Controls</h2>
<div class="row">
<div class="col"><label>Temperature</label><div class="slider"><input type="range" min="0" max="1.5" step="0.01" id="tempR"><input type="number" step="0.01" id="tempN"></div></div>
<div class="col"><label>Top-P</label><div class="slider"><input type="range" min="0" max="1" step="0.01" id="topPR"><input type="number" step="0.01" id="topPN"></div></div>
<div class="col"><label>Top-K</label><div class="slider"><input type="range" min="1" max="100" step="1" id="topKR"><input type="number" step="1" id="topKN"></div></div>
<div class="col"><label>Max Tokens</label><div class="slider"><input type="range" min="50" max="2048" step="1" id="maxR"><input type="number" step="1" id="maxN"></div></div>
</div>
</div>

<div class="section">
<h2>üß† Instruction & Prompt</h2>
<label>System / Instruction Prompt</label>
<textarea id="systemPrompt"></textarea>
<label>User Prompt</label>
<textarea id="userPrompt"></textarea>
<button id="runBtn" disabled>Run Prompt</button>
</div>

<div class="section">
<h2>üì§ Model Output</h2>
<div id="output" class="output">Waiting for input‚Ä¶</div>
<div id="meta" class="meta"></div>
</div>

<div class="section">
<h2>üìò Understanding Fine-Tuning</h2>
<p><b>Prompt engineering</b> is what you say.</p>
<p><b>Inference tuning</b> is how random or strict the model behaves.</p>
<p><b>Fine-tuning</b> means retraining the model on new data.</p>
<p>This playground demonstrates inference tuning ‚Äî not real fine-tuning.</p>
</div>

</div>

<script>
const presets=[
{name:"Innovative Thinker",t:1.2,p:0.95,k:40,m:512,s:"You are a creative, innovative thinker."},
{name:"Factual & Precise",t:0.2,p:0.8,k:20,m:512,s:"You are factual, precise, and concise."},
{name:"Funny Kid (8‚Äì10)",t:1.3,p:0.95,k:50,m:300,s:"You speak like a funny 8-year-old kid."},
{name:"Product Manager",t:0.6,p:0.9,k:30,m:600,s:"You think like an experienced product manager."},
{name:"No-Nonsense",t:0.1,p:0.7,k:15,m:400,s:"You are blunt and strictly factual."},
{name:"Custom",t:0.7,p:0.9,k:40,m:512,s:""}
];

const el=id=>document.getElementById(id);
const sync=(r,n)=>{ r.oninput=()=>n.value=r.value; n.oninput=()=>r.value=n.value; };

sync(el("tempR"),el("tempN"));
sync(el("topPR"),el("topPN"));
sync(el("topKR"),el("topKN"));
sync(el("maxR"),el("maxN"));

const presetBox=el("presetBox");
presets.forEach((p,i)=>{
  const l=document.createElement("label");
  const r=document.createElement("input");
  r.type="radio"; r.name="preset"; if(i===0) r.checked=true;
  r.onchange=()=>applyPreset(p);
  l.appendChild(r); l.append(" "+p.name);
  presetBox.appendChild(l);
});

function applyPreset(p){
  el("tempR").value=el("tempN").value=p.t;
  el("topPR").value=el("topPN").value=p.p;
  el("topKR").value=el("topKN").value=p.k;
  el("maxR").value=el("maxN").value=p.m;
  el("systemPrompt").value=p.s;
}
applyPreset(presets[0]);

el("validateBtn").onclick=async()=>{
  const key=el("apiKey").value.trim();
  const status=el("apiStatus");
  status.style.display="block";
  status.textContent="Validating API key‚Ä¶";
  status.className="status";
  try{
    const r=await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${key}`);
    if(!r.ok) throw new Error();
    const j=await r.json();
    const models=(j.models||[]).filter(m=>m.supportedGenerationMethods?.includes("generateContent"));
    el("modelSelect").innerHTML=models.map(m=>`<option value="${m.name}">${m.name}</option>`).join("");
    el("modelSelect").disabled=false;
    el("runBtn").disabled=false;
    status.textContent="API Key valid ‚úî Models loaded.";
    status.classList.add("ok");
  }catch{
    status.textContent="API key validation failed. Check key, network, or permissions.";
    status.classList.add("err");
  }
};

el("runBtn").onclick=async()=>{
  const key=el("apiKey").value.trim();
  const prompt=el("userPrompt").value.trim();
  if(!prompt){ el("output").textContent="Please enter a user prompt."; return; }
  el("output").textContent="Generating‚Ä¶";
  const model=el("modelSelect").value;
  const body={
    systemInstruction:{parts:[{text:el("systemPrompt").value}]},
    contents:[{role:"user",parts:[{text:prompt}]}],
    generationConfig:{
      temperature:+el("tempN").value,
      topP:+el("topPN").value,
      topK:+el("topKN").value,
      maxOutputTokens:+el("maxN").value
    }
  };
  try{
    const t0=performance.now();
    const r=await fetch(`https://generativelanguage.googleapis.com/v1beta/${model}:generateContent?key=${key}`,{
      method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(body)
    });
    if(!r.ok) throw new Error();
    const j=await r.json();
    const txt=j.candidates?.[0]?.content?.parts?.[0]?.text;
    if(!txt) throw new Error();
    el("output").textContent=txt;
    el("meta").textContent=`Model used: ${model} | Latency: ${Math.round(performance.now()-t0)} ms`;
  }catch{
    el("output").textContent="Generation failed. Try another model or check quota.";
    el("meta").textContent="";
  }
};
</script>
</body>
</html>